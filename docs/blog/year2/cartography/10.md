# 10.网络制图(Web Mapping)

## 历史
* 静态图片阶段
* 动态绘制阶段
* 瓦片（切片）地图时代（Tile Map）
* 交互式性的兴起
* 移动互联网

## 基本原理

1. 客户端（用户的电脑）把请求通过网络发送给服务器
2. 服务器收到请求后，处理请求，之后返回数据
3. 客户端显示地图

## ==三个要素==

- 底图(basemaps)：提供地理信息的背景。通常以瓦片地图提供。
- 专题图层(thematic layers)：在底图的上面，服务器端会经常更新，通常是向服务器请求数据之后在客户端绘制
- 交互元素(interactive elements)：弹出窗口、图表、滑条……

## 三种 ==网络地图服务==
* 服务器提前画好了所有地图，直接发送给用户
    * 缺点：要求服务器有较大的存储容量
* 服务器发送文本格式的数据，由客户端绘制地图
    * 缺点：对客户端有要求
* 服务器收到请求之后绘制地图，然后发给用户（动态地图）
    * 在收到请求时，服务器才即时绘制地图，并将生成的完整地图图像发送给浏览器。
    * 优点
        * 实时性强： 能够反映数据的最新状态。
        * 支持动态物体： 适合展示正在移动的对象（如实时公交、飞机的轨迹）。
        * 适合大比例尺地图： 在非常精细的层级下，切片地图的生成、存储和维护会变得极其繁重（切片数量呈指数级增长），此时动态绘制更划算。
        * 样式灵活： 允许使用更丰富的符号和样式。如SLDs (Styled Layer Descriptors)： 一种专门用于定义地图图层样式的 XML 标准，用于描述 WMS 中应使用的所有符号大小、颜色和标记。可以灵活调整颜色、粗细等。
    * 缺点：
        * 速度慢： 尤其是当需要渲染的图层很多时，服务器计算量大，加载会有延迟。
        * 并发承载力弱： 容易受到过载影响。当大量用户同时查看地图时，服务器可能因为处理不过来而崩溃。
## WMS

概念：一套网络地图的服务标准，由开放地理空间联盟 (OGC) 制定

用户向服务器发送GET请求，服务器返回地图

- WMS（Web Map Service网络地图服务）返回由服务器绘制的栅格化图像
- WFS（Web Feature Services网络要素服务）返回矢量几何与属性数据。
    - 允许用户在客户端进行空间数据和数据编辑
- WCS（Web Coverage Services空间覆盖服务）返回提供分块的数据（Coverage覆盖数据）常用于栅格显示与栅格分析
    - 通常用于原始栅格数据的展示和科学分析（如多光谱遥感影像）
- WPS（Web Processing Services网络处理服务）为用户提供在服务器上进行地理操作的功能


具体技术细节略

## 瓦片地图(Tiled maps)

* 服务器预先制作好地图，然后将其切分为不同级别的小块，客户端以小块为单位请求
* 投影：使用一种改进的球体墨卡托投影 (Spherical Mercator)。其唯一目的是为了方便将世界地图拟合到一组正方形切片中。
    * 警告： 不适用于测量！ 在进行任何测量之前，必须先投影到更精确的局部坐标系中。
* 特点：
    * 流量消耗和服务器开销小
    * 需要实时更新
* 创建切片与矢量切片（Vector Tiles）
    * 创建挑战：在大比例尺（高缩放级别）下，切片数量巨大，尤其是覆盖广阔区域时；很多切片（如海洋、沙漠）包含的信息很少，却占空间。
    * 对策： “按需创建”（Create tiles on demand）。
    * 优点：
        * 地图渲染在客户端完成
        * 矢量切片通常比图像切片体积更小
        * GeoWebCache 只需为不同样式存储一份切片数据
        * 可绘制高分辨率地图，而不会带来对应的带宽增长
        * 客户端可以直接访问真实的要素几何与属性信息
## Leaflet API

Leaflet API 是一个开源的 JavaScript 库，用于构建交互式地图。它轻量、灵活、易于使用，广泛应用于 Web 地图开发中。

!!! note "这不是我说的"
    （```手动[ac01]```）具体怎么用你就不需要知道了，不可能考这个。

## GeoJSON

是 JSON 的一种，以一套规范的格式来表示地理数据。

GeoJSON 以文本格式表示地理数据，用户获取到数据之后在自己的客户端绘制地图。