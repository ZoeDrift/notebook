# 人工智能模型窃取攻击与防御

## 模型窃取攻击原理

### 模型窃取攻击概述
攻击者目标：试图通过访问目标模型窃取模型参数或者功能的攻击。  

攻击者能力：目标模型参数不公开，攻击者不知道或者已知部分模型结构信息和标签信息。  

攻击者发起模型窃取攻击的动机：  
经济利益或技术优势：不愿意为访问模型的服务支付费用，或者希望通过窃取模型来获得不正当的竞争优势。  
提高其他攻击的成功率：模型被窃取后，黑盒模型转化为白盒模型，进而使用各种攻击手段，进一步影响AI系统的准确性和可靠性。  
### 模型窃取攻击主要方法

* 方程求解攻击
    * 攻击对象：针对支持向量机（SVM）等传统的机器学习方法的模型窃取攻击。
    * 攻击者知识：攻击者可以先获取模型的算法、结构等相关信息，能够查询模型获取结果。
    * 攻击原理：对于逻辑回归（LR）、支持向量机（SVM）、神经网络（NN）这类算法而言，我们可以将其模型看做是一个函数f，模型的输人是x，模型的输出结果是f（x），模型在训练过程中通过优化函数f里的参数来达分类的目的。
    * 缺点：方程求解攻击需要攻击者了解目标算法的类型、结构、训练数据集等信息，无法应用于复杂的神经网络模型。
* 基于替代模型的模型窃取攻击
    * 攻击原理：在本地训练一个与目标模型任务相同的替代模型，当经过大量训练之后，该模型就具有和目标模型相近的性质。
    * 区别：与万程求解攻击不同，攻击者对于目标模型的具体结构并不了解，训练替代模型不是为了获取目标模型的具体参数，而只是利用替代模型去拟合目标模型的功能。
    * 攻击方案
        * 受害者V（Victim V）：为一个具体任务训练一个CNN 模型Fv，提供黑盒访问接口。
        * 攻击者A（Adversary A）：通过黑盒访问受害者模型，训练一个替代模型
    * 攻击者这些信息是不可知的：
        * 1.Fv模型的内部构造；
        * 2.训练集K个类别的语义信息。
        * 3.训练集和测试集；
    * 攻击步骤一：构造迁移集
        * 首先要选择图像分布 $P_A(X)$ 来采样图像，这是一个比较大的离散数据集，例如可以用ImageNet数据集（1.2M张图像）作为 $P_C(X)$ 。
        * 然后选择采样策略
        * 随机策略：随机采样图像，极端情况（攻击者采样的图像可能和学习任务无关，比如F，是用于分类鸟的，但是来样的图像却是狗）。
        * 自适应策略：将每次查询得到的反馈信息集成合并（选择的好给出正反馈，不好则给负反馈），学习出一个查询策略。
    * 攻击步骤二：替代模型结构的选取
        * 替代模型的性能按模型复杂度排序：Alexnet结构最简单，但是性能最差，更复杂的Resnet-101/Densenet-161性能却更好，这说明在选择替代模型架构时，选一个复杂的架构更好。
        * 从中也能看出，查询次数越多，攻击效果越好。
    * 攻击结果：替代模型接近目标模型的功能

## 防御模型窃取攻击
### 模型窃取防御概述

场景  
开源模型的防盗  
闭源api防护  

### 模型窃取防御方法
* 模型混淆技术
    * 模型混淆技术可以自动混淆明文AI模型的计算逻辑。
    * 开发者对模型架构进行"雾化”处理，使得攻击者即使在传输和存储时获取到模型也无法理解。
    * 支持模型混淆态执行，能保证模型运行时的机密性。不影响模型原本的推理结果、仅带来较小的推理性能开销。
    * 方法
        * 在代码中植人随机噪声层，使逆向工程者难以分辨有效结构。
        * 对参数矩阵进行非线性变换，使攻击者即使获得权重文件，也无法直接使用。
* 访问控制
    * 基于角色的访问控制
    * 基于属性的访问控制
* 建立持续监测与应急响应体系
    * 持续监测：针对API服务，持续检测用户行为，对每个请求进行精细化管理。
        * API网关中部署的动态令牌系统，能够根据用户行为特征实时调整访问权限。
        * 当检测到某个API密钥在短时间内发起异常高频率请求时，系统会自动触发“蜜罐”机制，返回掺杂误导性数据的响应；或者，通过设定API调用的频率上限。
        * 动态模型切片技术。实际访问的是经过随机剪裁的模型
    * 应急响应
        * 对监测预警阶段的服务异常进行评估与决策，对确定的安全事件，根据事件类型和级别，启动安全事件应急响应预亲，应急协调并调度所需的相关人员、资金和技术工具等，进行模型安全保护。
### 模型版权保护方法
数字水印：  
是指在不影响信息载体，例如图片、视频的视觉质量及完整性的前提下，将数字信息，即数字水印，嵌入到信息载体中  

数字水印通常嵌入到模型的参数或输出结果中  

* 基于模型参数的水印方法
    * 通过深度绑定模型结构与版权信息，将身份标识转化为神经网络的内在特征。
    * 该方法的核心在于利用模型训练过程中参数空间的冗余性，在特定层级的权重矩阵中构建隐蔽的编码模式
* 基于模型输出的水印方法
    * 基于模型输出的水印方法，主要依赖于水印编码器和解码器的协作来实现水印的有效嵌入和提取。
    * 水印编码器会将特定的水印信息嵌入到生成的内容中。
    * 这个水印信息往往包含了生成模型的独特标识：模型的ID、开发者的身份、生成的时间戳
    * 版权验证：当需要对生成內容进行版权验证时，水印解码器就发挥了关键作用。